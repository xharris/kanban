(this.webpackJsonpsqueakr=this.webpackJsonpsqueakr||[]).push([[0],{323:function(e,t,n){},596:function(e,t){},644:function(e,t,n){},645:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n(0),r=n.n(a),o=n(15),i=n.n(o),s=(n(323),n(21)),l=n(28),u=n(6),j=n(5),b=(n(324),n(325)),d=function(e){return e.startsWith("http")?e:"".concat("https://squeakr.me/","api/").concat(e)},f=function(e,t,n,c){return c||(c={}),c.cancel&&(c.cancelToken=new b.CancelToken(c.cancel)),b(Object(u.a)({method:e,url:d(t),data:n},c))},O=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.apply(void 0,["get"].concat(t))},m=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.apply(void 0,["post"].concat(t))},h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.apply(void 0,["put"].concat(t))},p=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.apply(void 0,["patch"].concat(t))},g=n(37),v=n(304),x=n(288),C=n.n(x),y=function(){for(var e=null,t=null,n=function(){},c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];2===r.length&&(e=r[0],n=r[1]),3===r.length&&(e=r[0],t=r[1],n=r[2]),Object(a.useEffect)((function(){var c,a=(e||"").split("/"),r=Object(j.a)(a,2),o=r[0],i=r[1];return o&&(c=C()("".concat("https://squeakr.me/").concat(o)),i?c.on(i,(function(e){null!=t&&e!==t||n(e)})):c.onAny((function(e,c){null!=t&&c!==t||n(e,c)}))),function(){c&&c.disconnect()}}),[e,t])},N=function(e,t,n,c){var r=Object(a.useState)(),o=Object(j.a)(r,2),i=o[0],s=o[1],l=Object(a.useRef)(!0),u=Object(a.useCallback)((function(){t&&t.apply(void 0,arguments).then((function(e){if(!l.current)return e;s(e)}))}),[t]);Object(a.useEffect)((function(){return function(){l.current=!1}}),[]);var b=Object(a.useCallback)((function(){n&&n.apply(void 0,arguments).then((function(t){w(e)}))}),[n,e]);return k("fetch"===c?u:c,e),[i,u,b,s]},w=function(e,t){return _("fetch_one_".concat(e),{detail:{id:t}})},k=function(e,t,n){var c=Object(a.useCallback)((function(t){n&&t.detail.id!==n||e(t)}),[e,t,n]);Object(a.useEffect)((function(){if(t)return F("fetch_one_".concat(t),c),function(){D("fetch_one_".concat(t),c)}}),[])},S=function(e,t,n,c){var r=Object(a.useState)(c),o=Object(j.a)(r,2),i=o[0],s=o[1],l=function(){return e.apply(void 0,arguments).then((function(e){return s(e),e})).catch((function(e){console.error(e)}))},u=Object(a.useCallback)((function(e){return(null==e.detail.id||null==n||e.detail.id===n)&&l(n)}),[n]),b=Object(a.useCallback)((function(e){return t&&w(t,e||n)}),[t,n]);return Object(a.useEffect)((function(){if(t)return F("fetch_one_".concat(t),u),function(){D("fetch_one_".concat(t),u)}}),[]),[i,l,b,s]},E={},_=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return document.dispatchEvent(Object(v.a)(CustomEvent,t))},F=function(){var e;return(e=document).addEventListener.apply(e,arguments)},D=function(){var e;return(e=document).removeEventListener.apply(e,arguments)},A=function(){var e=Object(l.h)().search,t=Object(l.g)(),n=t.location,c=t.replace,r=Object(a.useState)(),o=Object(j.a)(r,2),i=o[0],s=o[1];Object(a.useEffect)((function(){s(new URLSearchParams(e))}),[e]);var u=Object(a.useCallback)((function(){i&&c(n.pathname+"?"+i.toString())}),[i]),b=Object(a.useCallback)((function(e,t){i&&(t?i.set(e,t):i.delete(e),u())}),[i]),d=Object(a.useCallback)((function(e){i&&(i.delete(e),u())}),[i]);return{params:i,setParam:b,removeParam:d}},B=function(e,t){return 1===e?"":t},z=function(e){return e&&"object"===typeof e&&!Array.isArray(e)},I=function e(t){for(var n=arguments.length,c=new Array(n>1?n-1:0),a=1;a<n;a++)c[a-1]=arguments[a];if(!c.length)return t;var r=c.shift();if(z(t)&&z(r))for(var o in r)z(r[o])?(t[o]||Object.assign(t,Object(g.a)({},o,{})),e(t[o],r[o])):Object.assign(t,Object(g.a)({},o,r[o]));return e.apply(void 0,[t].concat(c))},L=function(e){return N("user/theme",(function(e){return O("user/theme/".concat(e)).then((function(e){return e.data._doc.theme}))}),(function(e){return h("user/theme/update",e,{withCredentials:!0})}),e)},R=function(e){return m("user/get",{values:[].concat(e),key:"username"})},P=function(e){return m("user/search",{term:e})},T=Object(a.createContext)({signIn:function(){},signOut:function(){},signUp:function(){},user:null}),U=function(){return Object(a.useContext)(T)},q=function(e){var t=e.children,n=Object(l.h)(),r=(Object(l.g)(),Object(a.useState)()),o=Object(j.a)(r,2),i=o[0],s=o[1],b=Object(a.useState)(),d=Object(j.a)(b,2),f=(d[0],d[1],function(e,t,n){return function(e){var t=e.id,n=e.pwd,c=e.remember;return m("user/login",{remember:c},{withCredentials:!0,headers:{authorization:btoa("".concat(t,":").concat(n))}})}({id:e,pwd:t,remember:n}).then((function(e){return s(Object(u.a)({},e.data.data))}))}),O=function(){return m("user/logout",{},{withCredentials:!0}).then((function(e){return s()}))};return Object(a.useEffect)((function(){m("user/verify",{},{withCredentials:!0}).then((function(e){return s(Object(u.a)({},e.data.data))})).catch(O)}),[n.pathname]),Object(c.jsx)(T.Provider,{value:{signIn:f,signUp:function(e){return(t=e,m("user/add",t)).then((function(){return f(e.id,e.pwd)}));var t},signOut:O,user:i},children:t})},V=n(12),W=n(95),H=n(691),M=W.css,J=W.cx,K=function(e){return function(){for(var t={},n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];c.forEach((function(e){return"object"===typeof e&&Object.entries(e).forEach((function(e){var n=Object(j.a)(e,2),c=n[0],a=n[1];return"undefined"!==c&&(t[c]=a)}))}));var r=c.filter((function(e){return["string","boolean"].includes(typeof e)})),o=[r.map((function(t){return"".concat(e,"--").concat(t)})),Object.entries(t).map((function(t){var n=Object(j.a)(t,2),c=n[0],a=n[1];return a&&"".concat(e,"--").concat(c).concat(!0!==a&&"function"!==typeof a?"-".concat(a):"")})).filter((function(e){return e})).join(" ")];return W.cx.apply(W,[0===r.length&&e].concat(o))}},G=function(e,t,n){if(n=n||30,!e)return"#ffffff";var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),a=Math.pow(parseInt(c[1],16),2),r=Math.pow(parseInt(c[2],16),2),o=Math.pow(parseInt(c[3],16),2),i=Math.sqrt(.299*a+.587*r+.114*o);return t?Y(t,(i>130?-1:1)*n):i>130?"#212121":"#F5F5F5"},Y=function(e,t){return t>=0?new H.a(e).brighten(t).toString():new H.a(e).darken(Math.abs(t)).toString()},$=function(e,t){var n=0,c=0,a=0;return 4==e.length?(n="0x"+e[1]+e[1],c="0x"+e[2]+e[2],a="0x"+e[3]+e[3]):7==e.length&&(n="0x"+e[1]+e[2],c="0x"+e[3]+e[4],a="0x"+e[5]+e[6]),[+n,+c,+a,t||1]},Q=(K("dragdrop"),Object(a.createContext)({draggingData:{},setDraggingData:function(){},clearDraggingData:function(){},setTypeDragging:function(){},setIdDragging:function(){},setCopying:function(){}})),X=function(e){var t=e.children,n=Object(a.useState)({}),r=Object(j.a)(n,2),o=r[0],i=r[1];return Object(a.useEffect)((function(){var e=function(e){return i(Object(u.a)(Object(u.a)({},o),{},{copy:17===e.keyCode}))};return document.addEventListener("keydown",e),document.addEventListener("keyup",e),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",e)}}),[]),Object(c.jsx)(Q.Provider,{value:{draggingData:o,setDraggingData:function(e){return i(Object(u.a)(Object(u.a)({},o),e))},clearDraggingData:function(){return i({})},setTypeDragging:function(e){return i(Object(u.a)(Object(u.a)({},o),{},{type:[].concat(e)}))},setIdDragging:function(e){return i(Object(u.a)(Object(u.a)({},o),{},{id:e}))}},children:t})},Z=n(35),ee=(K("dndlist"),{postview:{view_type:"new"},postview_ui:{showcontrols:!0}}),te=Object(a.createContext)({settings:ee,setSettings:function(){}}),ne=function(e){var t=Object(a.useContext)(te),n=t.settings,c=t.setSetting;return[n[e]||ee[e],function(t,n){return c(e,t,n)}]},ce=function(e){var t=e.children,n=localStorage.getItem("settings")||{};try{n=JSON.parse(localStorage.getItem("settings"))}catch(l){n={}}var r=Object(a.useState)(I(ee,n)),o=Object(j.a)(r,2),i=o[0],s=o[1];return Object(a.useEffect)((function(){localStorage.setItem("settings",JSON.stringify(i))}),[i]),Object(c.jsx)(te.Provider,{value:{settings:i,setSetting:function(e,t,n){return s(Object(u.a)(Object(u.a)({},i),{},Object(g.a)({},e,Object(u.a)(Object(u.a)({},i[e]),{},Object(g.a)({},t,n)))))}},children:t})},ae=n(684),re=n(303),oe=n(680),ie={primary:"#F5F5F5",secondary:"#F5F5F5",font:"-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n  'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n  sans-serif",header_char:"\\"},se=Object(a.createContext)({theme:ie,color:function(){},setTheme:function(){},getColor:function(){}}),le=function(){return Object(a.useContext)(se)},ue=function(e){var t=e.theme,n=e.username,r=e.notheme,o=e.children,i=L((function(){return n&&u(n)})),s=Object(j.a)(i,2),l=s[0],u=s[1],b=Object(a.useState)(t||ie),d=Object(j.a)(b,2),f=d[0],O=d[1],m=Object(a.useState)(Object(re.a)({palette:{primary:{main:ie.primary},secondary:{main:ie.secondary}}})),h=Object(j.a)(m,2),p=h[0],g=h[1];return Object(a.useEffect)((function(){g(Object(re.a)({palette:{primary:{main:f.primary},secondary:{main:f.secondary}}}))}),[f]),Object(a.useEffect)((function(){var e=r?ie:t||l;e&&O(e)}),[t,l,r]),Object(c.jsx)(oe.a,{theme:p,children:Object(c.jsx)(se.Provider,{value:{theme:f,getColor:function(e,t,n){return G(f[e]||e||f.primary,f[t]||t||f.secondary,n)},setTheme:function(e){return O(e||f)}},children:o})})},je=n(693),be=K("text"),de=function(e){var t=e.className,n=e.themed,a=e.color,r=void 0===a?"primary":a,o=e.bg,i=void 0===o?"secondary":o,s=e.amt,l=void 0===s?20:s,j=e.children,b=Object(V.a)(e,["className","themed","color","bg","amt","children"]),d=le(),f=(d.theme,d.getColor);return Object(c.jsx)("div",Object(u.a)(Object(u.a)({className:J(be(),M({color:n&&f(r,i,l)}),t)},b),{},{children:j}))},fe=n(301),Oe=K("icon"),me=function(e){var t=e.icon,n=e.className,a=e.label,r=Object(V.a)(e,["icon","className","label"]),o=fe[t];return Object(c.jsxs)("div",{className:J(Oe(),n),children:[null!=a&&Object(c.jsx)("div",{className:Oe("label"),children:a}),Object(c.jsx)(o,Object(u.a)({},r))]})},he=K("button"),pe=Object(a.forwardRef)((function(e,t){var n=e.icon,r=e.iconPlacement,o=e.to,i=e.onClick,l=e.className,b=e.rounded,d=e.popover,f=e.label,O=e.outlined,m=e.type,h=void 0===m?"button":m,p=(e.link,e.underline),g=e.thickness,v=void 0===g?1:g,x=e.title,C=e.size,y=e.disabled,N=e.bg,w=void 0===N?"secondary":N,k=e.color,S=void 0===k?"primary":k,E=e.amt,_=void 0===E?20:E,F=Object(V.a)(e,["icon","iconPlacement","to","onClick","className","rounded","popover","label","outlined","type","link","underline","thickness","title","size","disabled","bg","color","amt"]),D=le().getColor,A=Object(a.useState)(),B=Object(j.a)(A,2),z=B[0],I=B[1],L=function(){return Object(c.jsxs)(c.Fragment,{children:[n&&"right"!==r&&Object(c.jsx)(me,{icon:n}),null!=f&&Object(c.jsx)(de,{className:he("label"),themed:!0,children:f}),n&&"right"===r&&Object(c.jsx)(me,{icon:n})]})},R=M({borderWidth:"link"!==h&&O?v:0,borderColor:O&&D(S,w,_),textDecoration:("link"===h||p)&&!y&&"underline ".concat(D(w,S,_)),"& > *":{color:"link"===h?D(w,S,_):D(S,w,_)},"&:hover":{backgroundColor:"link"!==h&&D(S,w,_)},"&:hover > *":"link"!==h&&{borderColor:D(S,w,_),color:D(S,w,-_),textDecoration:p&&!y&&"underline ".concat(D(S,S,-_))}});return o?Object(c.jsx)(je.a,{title:x||"",disableFocusListener:!x,disableHoverListener:!x,disableTouchListener:!x,placement:"top",children:Object(c.jsx)(s.b,Object(u.a)(Object(u.a)({className:J(he({type:h,size:C}),R,l),ref:t,to:o,disabled:y},F),{},{children:Object(c.jsx)(L,{})}))},"tooltip"):[Object(c.jsx)(je.a,{title:x||"",disableFocusListener:!x,disableHoverListener:!x,disableTouchListener:!x,placement:"top",children:Object(c.jsx)("button",Object(u.a)(Object(u.a)({ref:t,className:J(he({type:h,rounded:b,outlined:O}),R,l),onClick:function(e){i&&i(e),d&&I(e.currentTarget)},type:h||"button",disabled:y},F),{},{children:Object(c.jsx)(L,{})}),"button")},"tooltip"),Object(c.jsx)(ae.a,{className:J(he("popover"),l),open:null!=z,anchorEl:z,onClose:function(){return I(null)},anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"},children:d&&d({onClose:function(){return I(null)}})},"popover")]})),ge=n(685),ve=n(647),xe=n(648),Ce=n(683),ye=n(690),Ne=n(694),we=K("menubutton"),ke=function(e){var t=e.label,n=e.items,r=e.closeOnSelect,o=e.className,i=e.color,s=e.icon,b=Object(V.a)(e,["label","items","closeOnSelect","className","color","icon"]),d=(Object(l.g)(),Object(a.useState)(!1)),f=Object(j.a)(d,2),O=f[0],m=f[1],h=Object(a.useRef)(),p=Object(a.useRef)(O),g=function(e){h.current&&!h.current.contains(e.target)&&(m(!1),h.current.blur())},v=function(e){"Tab"===e.key&&(e.preventDefault(),m(!1))};return Object(a.useEffect)((function(){!0===p.current&&!1===O&&h.current.focus(),p.current=O}),[O]),Object(c.jsxs)("div",{className:J(we(),o),children:[Object(c.jsx)(pe,Object(u.a)({ref:h,onClick:function(){m((function(e){return!e}))},label:t,icon:s||"ArrowDropDown",iconPlacement:"right",color:i},b)),Object(c.jsx)(Ce.a,{open:O,anchorEl:h.current,transition:!0,disablePortal:!0,children:function(e){var t=e.TransitionProps,a=e.placement;return Object(c.jsx)(ve.a,Object(u.a)(Object(u.a)({},t),{},{style:{transformOrigin:"bottom"===a?"left top":"left bottom"},children:Object(c.jsx)(xe.a,{children:Object(c.jsx)(ge.a,{onClickAway:g,children:Object(c.jsx)(Ne.a,{autoFocusItem:O,onKeyDown:v,children:n.map((function(e,t){return Object(c.jsx)(ye.a,Object(u.a)(Object(u.a)({classes:{root:"MenuItem"}},e),{},{onClick:function(t){e.onClick&&e.onClick(t,e),r&&g(t)},component:e.to&&"a",href:e.to,children:e.label}),t)}))})})})}))}})]})},Se=(K("expandable"),n(692)),Ee=K("dialog"),_e=function(e){var t=e.className,n=e.open,a=e.onClose,r=e.children;return Object(c.jsx)(Se.a,{open:!!n,className:J(Ee(),t),onClose:function(){a&&a(!1)},children:r})},Fe=K("input"),De=Object(a.forwardRef)((function(e,t){var n=e.className,r=e.color,o=e.bg,i=e.tooltip,s=e.outlined,l=e.children,b=e.showinput,d=e.disabled,f=e.size,O=e.onClear,m=e.onSubmit,h=e.submitIcon,p=e.dirty,g=e.width,v=e.noWrap,x=Object(V.a)(e,["className","color","bg","tooltip","outlined","children","showinput","disabled","size","onClear","onSubmit","submitIcon","dirty","width","noWrap"]),C=le(),y=(C.theme,C.getColor),N=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var c=Object(a.useRef)();return Object(a.useEffect)((function(){t.forEach((function(e){e&&("function"===typeof e?e(c.current):e.current=c.current)}))}),[t]),c}(t,Object(a.useRef)()),w=Object(a.useState)(),k=Object(j.a)(w,2),S=k[0],E=k[1],_=Object(a.useCallback)((function(e){return N&&N.current&&m&&m(N.current.value),e.stopPropagation(),e.preventDefault()}),[N,m]);return Object(c.jsx)(je.a,{title:i||"",disableFocusListener:!i,disableHoverListener:!i,disableTouchListener:!i,placement:"top",className:J(Fe(),n),children:Object(c.jsxs)("div",{className:J(Fe("container",{focused:S}),M({backgroundColor:y(r,o,-15),minHeight:"small"===f?21:32,":hover, :focus":!d&&{border:"1px solid ".concat(y(r,o))},boxShadow:!d&&S&&"0px 0px 3px 1px ".concat(y(r,o)),border:(s||S)&&!d&&"1px solid ".concat(y(r,o)),width:g,flexWrap:l&&l.length>0&&!v?"wrap":"nowrap"})),onClick:function(e){return N&&N.current&&e.currentTarget===N.current&&N.current.focus(),e.preventDefault()},children:[l,!1!==b&&Object(c.jsx)("input",Object(u.a)({ref:N,className:J(Fe("input"),M({"::placeholder":{color:y(r,r)},flexBasis:g,height:"small"===f?13:24})),onFocus:function(){return E(!0)},onBlur:function(){return E(!1)},onKeyDown:function(e){return m&&"Enter"===e.key&&_(e)},disabled:d},x)),O&&(null==p||!0===p)&&Object(c.jsx)(pe,{icon:"Close",title:"clear",className:M({marginLeft:3,cursor:"pointer"}),onClick:O,tabIndex:2}),m&&Object(c.jsx)(pe,{icon:h,title:"submit",className:M({marginLeft:3,cursor:"pointer"}),onClick:_,tabIndex:2})]})})})),Ae=n(689),Be=n(695),ze=n(686),Ie=K("box"),Le=function(e){var t=e.className,n=e.color,a=void 0===n?"primary":n,r=e.bg,o=void 0===r?"secondary":r,i=e.amt,s=void 0===i?4:i,l=e.themed,j=Object(V.a)(e,["className","color","bg","amt","themed"]),b=le().getColor;return Object(c.jsx)("div",Object(u.a)({className:J(Ie(),M({borderRadius:4,backgroundColor:l?b(a,o,s):b("#F5F5F5","#F5F5F5",s)}),t)},j))},Re=K("form"),Pe=Object(a.createContext)({onChange:function(){}}),Te=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){var a=n.className,r=n.label,o=n.name,i=n.required,s=n.onChange,l=Object(V.a)(n,["className","label","name","required","onChange"]),j=function(e){var t=e.onChange;return Object(u.a)(Object(u.a)({},l),{},{onChange:function(e){return s?s(e.target?e.target.value:e):t({label:o||r,value:e.target?e.target.value:e})},name:o,label:r})};return t.noctrl?Object(c.jsx)(Pe.Consumer,{children:function(t){return Object(c.jsx)(e,Object(u.a)({},j(t)))}}):Object(c.jsx)(ze.a,{required:i,className:a,children:Object(c.jsx)(Pe.Consumer,{children:function(t){return Object(c.jsx)(e,Object(u.a)({},j(t)))}})})}},Ue=Te((function(e){var t=e.type,n=e.label,a=Object(V.a)(e,["type","label"]);return Object(c.jsx)(De,Object(u.a)({className:Re("input",{type:t}),type:t,placeholder:n},a))})),qe=Te((function(e){var t=e.defaultValue,n=e.onChange,r=e.label,o=e.color,i=e.bg,s=Object(V.a)(e,["defaultValue","onChange","label","color","bg"]),l=le().theme,b=Object(a.useState)(!!t),d=Object(j.a)(b,2),f=d[0],O=d[1];Object(a.useEffect)((function(){n({target:{value:f}})}),[f]);var m=i||l.primary,h=l[o]||o||l.primary;return Object(c.jsxs)("label",{tabIndex:0,className:J(Re("checkbox"),M({color:G(m,h,40),"&:hover":{backgroundColor:G(m,h,20)},"&:hover > *":{color:G(h,h,120)},"& > *":{color:G(m,h,40)}})),children:[Object(c.jsx)(me,{className:M({color:G(h||l.secondary,m,30)}),icon:f?"CheckBox":"CheckBoxOutlineBlank"}),Object(c.jsx)(de,{children:r}),Object(c.jsx)("input",Object(u.a)({className:M({color:G(h||l.secondary,m)}),type:"checkbox",defaultChecked:!!t,onChange:function(e){return O(e.target.checked)}},s))]})}),{noctrl:!0}),Ve=Te(qe),We=Te((function(e){var t=e.label,n=e.name,r=e.items,o=e.defaultValue,i=e.onChange,s=Object(V.a)(e,["label","name","items","defaultValue","onChange"]),l=Object(a.useState)(o||r&&r[0].value),b=Object(j.a)(l,2),d=b[0],f=b[1];return Object(a.useEffect)((function(){i({target:{value:d}})}),[d]),[t&&Object(c.jsx)(Be.a,{id:"form-select-".concat(n,"-label"),children:t},"label"),Object(c.jsx)(Ae.a,Object(u.a)(Object(u.a)({labelId:t&&"form-select-".concat(n,"-label"),size:"small",margin:"dense",value:d,onChange:function(e){return f(e.target.value)}},s),{},{children:r&&r.map((function(e){return Object(c.jsx)(ye.a,{value:e.value,children:e.label||e.value},e.value)}))}),"select")]})),He=function(e){var t=e.title,n=e.className,a=e.color,r=e.bg,o=void 0===r?"#ffffff":r,i=e.amt,s=e.children;return Object(c.jsxs)("div",{className:J(Re("group"),n),children:[Object(c.jsx)(de,{className:Re("group_title"),color:a,bg:o,amt:i,children:t}),Object(c.jsx)(Le,{className:Re("group_children"),themed:!0,children:s})]})},Me=function(e){var t=e.data,n=e.children,r=e.onSave,o=e.onChange,i=e.className,s=Object(a.useState)(t||{}),l=Object(j.a)(s,2),b=l[0],d=l[1];Object(a.useEffect)((function(){o&&o(b)}),[b]);var f=Object(a.useCallback)((function(e,t){return d(Object(u.a)(Object(u.a)({},b),{},Object(g.a)({},e,t)))}));return Object(c.jsx)(Pe.Provider,{value:{onChange:function(e){var t=e.label,n=e.value;return f(t,n)}},children:Object(c.jsx)("form",{className:J(Re(),i),onSubmit:function(e){r&&r(b),e.preventDefault()},children:n&&n({data:b,setField:f,setData:d,SubmitButton:function(e){return r?Object(c.jsx)(pe,Object(u.a)({type:"submit"},e)):Object(c.jsx)(c.Fragment,{})},Input:Ue,Select:We,Checkbox:Ve,Group:He})})})},Je=K("loginmodal"),Ke={USER_NOT_FOUND:"Email not found",BAD_LOGIN:"Username or password incorrect",PASS_NO_MATCH:"Passwords do not match",DUPLICATE:"Username already exists",UNKNOWN:"Could not sign in"},Ge=function(e){var t=e.signUp,n=e.open,r=e.onClose,o=U(),i=o.signIn,s=o.signUp,l=Object(a.useState)(),u=Object(j.a)(l,2),b=u[0],d=u[1],f=Object(a.useState)(t),O=Object(j.a)(f,2),m=O[0],h=O[1],p=Object(a.useState)(),g=Object(j.a)(p,2),v=g[0],x=g[1];return Object(a.useEffect)((function(){h(t)}),[t]),Object(c.jsx)(_e,{className:Je(),onClose:r,open:n,children:Object(c.jsx)(Me,{className:Je("form"),onSave:function(e){m?e.pwd!==v?d("PASS_NO_MATCH"):s(e).catch((function(e){return d(e.response?e.response.data.message:"UNKNOWN")})):(d(),i(e.id,e.pwd,e.remember).then((function(){return r()})).catch((function(e){return d(e.response?e.response.data.message:"UNKNOWN")})))},children:function(e){var t=e.Input,n=e.Checkbox,a=e.SubmitButton,r=e.Group;return[Object(c.jsxs)(r,{title:m?"Sign up":"Log in",children:[Object(c.jsx)(t,{label:"email",name:"id",type:"email",required:!0}),Object(c.jsx)(t,{label:"password",name:"pwd",type:"password",required:!0}),m&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(t,{label:"confirm password",type:"password",onChange:x}),Object(c.jsx)(t,{label:"username",name:"username"})]}),!m&&Object(c.jsx)(n,{label:"remember me",name:"remember"}),Object(c.jsx)(a,{label:m?"Sign up":"Login",color:"secondary",bg:"secondary",outlined:!0})]}),b&&Object(c.jsx)("div",{className:Je("error"),children:Ke[b]},"error"),Object(c.jsx)(pe,{className:Je("switchform"),label:"".concat(m?"Log in":"Sign up"," instead"),onClick:function(){return h(!m)&&d()},color:"secondary",bg:"secondary",link:!0},"switch_form")]}})})},Ye=K("overflowdialog"),$e=function(e){var t=e.open,n=e.onClose,r=e.closeButton,o=e.centered,i=e.children,s=e.className,l=e.transparent,u=Object(a.useState)(!!t),b=Object(j.a)(u,2),d=b[0],f=b[1];Object(a.useEffect)((function(){f(!!t)}),[t]);var O=Object(a.useRef)();return Object(c.jsx)("div",{className:J(Ye({open:d,centered:o,transparent:l}),s),children:d&&[r&&Object(c.jsx)(pe,{className:Ye("close"),icon:"Close",onClick:function(){return n(!1)},color:"#ffffff",outlined:!0},"close"),Object(c.jsx)("div",{className:Ye("children"),onClick:function(e){e.target!==O.current||r||(n?(console.log("out!"),n(!1)):f(!1))},ref:O,children:i},"children")]})};function Qe(e,t){var n=e[0],c=e[1],a=e[2],r=e[3];n=Ze(n,c,a,r,t[0],7,-680876936),r=Ze(r,n,c,a,t[1],12,-389564586),a=Ze(a,r,n,c,t[2],17,606105819),c=Ze(c,a,r,n,t[3],22,-1044525330),n=Ze(n,c,a,r,t[4],7,-176418897),r=Ze(r,n,c,a,t[5],12,1200080426),a=Ze(a,r,n,c,t[6],17,-1473231341),c=Ze(c,a,r,n,t[7],22,-45705983),n=Ze(n,c,a,r,t[8],7,1770035416),r=Ze(r,n,c,a,t[9],12,-1958414417),a=Ze(a,r,n,c,t[10],17,-42063),c=Ze(c,a,r,n,t[11],22,-1990404162),n=Ze(n,c,a,r,t[12],7,1804603682),r=Ze(r,n,c,a,t[13],12,-40341101),a=Ze(a,r,n,c,t[14],17,-1502002290),n=et(n,c=Ze(c,a,r,n,t[15],22,1236535329),a,r,t[1],5,-165796510),r=et(r,n,c,a,t[6],9,-1069501632),a=et(a,r,n,c,t[11],14,643717713),c=et(c,a,r,n,t[0],20,-373897302),n=et(n,c,a,r,t[5],5,-701558691),r=et(r,n,c,a,t[10],9,38016083),a=et(a,r,n,c,t[15],14,-660478335),c=et(c,a,r,n,t[4],20,-405537848),n=et(n,c,a,r,t[9],5,568446438),r=et(r,n,c,a,t[14],9,-1019803690),a=et(a,r,n,c,t[3],14,-187363961),c=et(c,a,r,n,t[8],20,1163531501),n=et(n,c,a,r,t[13],5,-1444681467),r=et(r,n,c,a,t[2],9,-51403784),a=et(a,r,n,c,t[7],14,1735328473),n=tt(n,c=et(c,a,r,n,t[12],20,-1926607734),a,r,t[5],4,-378558),r=tt(r,n,c,a,t[8],11,-2022574463),a=tt(a,r,n,c,t[11],16,1839030562),c=tt(c,a,r,n,t[14],23,-35309556),n=tt(n,c,a,r,t[1],4,-1530992060),r=tt(r,n,c,a,t[4],11,1272893353),a=tt(a,r,n,c,t[7],16,-155497632),c=tt(c,a,r,n,t[10],23,-1094730640),n=tt(n,c,a,r,t[13],4,681279174),r=tt(r,n,c,a,t[0],11,-358537222),a=tt(a,r,n,c,t[3],16,-722521979),c=tt(c,a,r,n,t[6],23,76029189),n=tt(n,c,a,r,t[9],4,-640364487),r=tt(r,n,c,a,t[12],11,-421815835),a=tt(a,r,n,c,t[15],16,530742520),n=nt(n,c=tt(c,a,r,n,t[2],23,-995338651),a,r,t[0],6,-198630844),r=nt(r,n,c,a,t[7],10,1126891415),a=nt(a,r,n,c,t[14],15,-1416354905),c=nt(c,a,r,n,t[5],21,-57434055),n=nt(n,c,a,r,t[12],6,1700485571),r=nt(r,n,c,a,t[3],10,-1894986606),a=nt(a,r,n,c,t[10],15,-1051523),c=nt(c,a,r,n,t[1],21,-2054922799),n=nt(n,c,a,r,t[8],6,1873313359),r=nt(r,n,c,a,t[15],10,-30611744),a=nt(a,r,n,c,t[6],15,-1560198380),c=nt(c,a,r,n,t[13],21,1309151649),n=nt(n,c,a,r,t[4],6,-145523070),r=nt(r,n,c,a,t[11],10,-1120210379),a=nt(a,r,n,c,t[2],15,718787259),c=nt(c,a,r,n,t[9],21,-343485551),e[0]=it(n,e[0]),e[1]=it(c,e[1]),e[2]=it(a,e[2]),e[3]=it(r,e[3])}function Xe(e,t,n,c,a,r){return t=it(it(t,e),it(c,r)),it(t<<a|t>>>32-a,n)}function Ze(e,t,n,c,a,r,o){return Xe(t&n|~t&c,e,t,a,r,o)}function et(e,t,n,c,a,r,o){return Xe(t&c|n&~c,e,t,a,r,o)}function tt(e,t,n,c,a,r,o){return Xe(t^n^c,e,t,a,r,o)}function nt(e,t,n,c,a,r,o){return Xe(n^(t|~c),e,t,a,r,o)}function ct(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}var at="0123456789abcdef".split("");function rt(e){for(var t="",n=0;n<4;n++)t+=at[e>>8*n+4&15]+at[e>>8*n&15];return t}function ot(e){return function(e){for(var t=0;t<e.length;t++)e[t]=rt(e[t]);return e.join("")}(function(e){var t,n=e.length,c=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Qe(c,ct(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(Qe(c,a),t=0;t<16;t++)a[t]=0;return a[14]=8*n,Qe(c,a),c}(e))}function it(e,t){return e+t&4294967295}if("5d41402abc4b2a76b9719d911017c592"!=ot("hello"));var st=K("textarea"),lt=function(e){var t=e.className,n=e.acceptFiles,r=e.onChange,o=e.defaultValue,i=e.color,s=e.bg,l=Object(V.a)(e,["className","acceptFiles","onChange","defaultValue","color","bg"]),b=Object(a.useState)(),d=Object(j.a)(b,2),f=d[0],O=d[1],h=Object(a.useState)(),p=Object(j.a)(h,2),g=p[0],v=p[1],x=Object(a.useState)(o),C=Object(j.a)(x,2),y=C[0],N=C[1],w=Object(a.useRef)(),k=le().getColor,S=Object(a.useState)([0,0]),E=Object(j.a)(S,2),_=E[0],F=E[1],D=Object(a.useCallback)((function(e,t){if(w.current){var n="![".concat(e,"](uploading...)"),c="![".concat(e,"](").concat(t,")");w.current.value=w.current.value.replaceAll(n,c),N(w.current.value)}}),[w]);Object(a.useEffect)((function(){r&&r({target:{value:y}})}),[y]);var A=Object(a.useCallback)((function(e){e.dataTransfer.files.length>0&&n&&w.current&&(Array.from(e.dataTransfer.files).forEach((function(e){e.text().then((function(t){return function(e,t){if(document.selection)e.focus(),document.selection.createRange().text=t;else if(e.selectionStart||0===e.selectionStart){var n=e.selectionStart,c=e.selectionEnd;e.value=e.value.substring(0,n)+t+e.value.substring(c,e.value.length)}else e.value+=t}(w.current,"![".concat(e.type,"-").concat(e.name,"](uploading...)\n"))})),function(e,t){var n=new FormData;return n.append("file",e),t&&n.append("data",t),m("file/upload",n,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}})}(e).then((function(t){return D("".concat(e.type,"-").concat(e.name),t.data.url)})).catch((function(t){return D("".concat(e.type,"-").concat(e.name),"failed to upload")}))})),v(!1),e.preventDefault())}),[w,n]),B=function(e){if(e.dataTransfer.files.lenth>0&&A)return v(!0),e.preventDefault(),!1};return Object(a.useEffect)((function(){if(g&&w.current){var e=w.current.getBoundingClientRect();F([e.width,e.height])}}),[g,w]),Object(c.jsxs)("div",{className:J(st({dropping:g}),t,M({})),onDrop:A,children:[g&&Object(c.jsx)("div",{className:J(st("drop"),M({width:_[0],height:_[1]})),children:"Drop file to upload"}),Object(c.jsx)("textarea",Object(u.a)(Object(u.a)({ref:w,className:J(st("textarea"),M({backgroundColor:k(i,s,-15),boxShadow:f&&"0px 0px 3px 1px ".concat(k(i,s)),":hover":{border:"1px solid ".concat(k(i,s))},"::placeholder":{color:k(i,i)}}))},l),{},{value:y||"",onChange:function(e){return N(e.target.value)},onDragOver:B,onDragEnter:B,onDragLeave:function(e){return v(!1)},onFocus:function(){return O(!0)},onBlur:function(){return O(!1)}}))]})},ut=function(e){var t=S((function(t){return t||e?function(e){return m("following/user/".concat(e),{},{withCredentials:!0})}(t||e).then((function(e){return e.data.following})):Promise.reject()}),"user_follow"),n=Object(j.a)(t,2),c=n[0],r=n[1],o=function(e){var t=e.fn,n=e.type,c=e.data,r=e.key,o=e.cooldown,i=e.skip_notify,s=Object(a.useState)(c),l=Object(j.a)(s,2),b=l[0],d=l[1],f="object"===typeof O,O=f?Object(u.a)({},c):c,m=function(e,c){return t(O).then((function(t){return O&&!i&&w(n,f&&O[r||"_id"]),e(t)})).catch(c)};return[b,function(e){return new Promise((function(n,c){O="object"===typeof e?Object(u.a)(Object(u.a)({},b),e):e,d(O),o&&0!==o?E[t]||(E[t]=setTimeout((function(){m(n,c),E[t]=null}),o)):m(n,c)}))},function(e){d(e),O=e}]}({fn:function(t){return c?function(e){return h("unfollow/user/".concat(e),{},{withCredentials:!0})}(t||e).then((function(e){return e.data})):function(e){return h("follow/user/".concat(e),{},{withCredentials:!0})}(t||e).then((function(e){return e.data}))},type:"user_follow"}),i=Object(j.a)(o,2)[1];return[c,i,r]},jt="follow/group",bt=function(e){return N(jt,(function(e){return(t=e,m("following/group/".concat(t),{},{withCredentials:!0})).then((function(e){return e.data}));var t}),(function(e,t){return e?(n=t,h("unfollow/group/".concat(n),{},{withCredentials:!0})).then((function(e){return e.data})):function(e){return h("follow/group/".concat(e),{},{withCredentials:!0})}(t).then((function(e){return e.data}));var n}),e)},dt=function(){return N(jt,(function(){return m("following/groups".concat(e?"/".concat(e):""),{},{withCredentials:!0}).then((function(e){return e.data.docs})).catch((function(){return[]}));var e}),null,"fetch")},ft=function(e){return"/u/".concat(e)},Ot=function(e){return"/p/".concat(e)},mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.group;return t?"/explore?group=".concat(t):"/explore"},ht=function(e){var t=e.username,n=e.tags;return t?"/u/".concat(t,"?tags=").concat(n.join(",")):"/explore?tags=".concat(n.join(","))},pt=function(e){return m("group/search",{term:e},{withCredentials:!0})},gt=function(){return S((function(e){return pt(e).then((function(e){return e.data.docs}))}))},vt=K("group"),xt=function(e){var t=e.data,n=e.name,r=e.outlined,o=e.hideJoined,i=e.linked,s=U().user,l=Object(a.useState)(t),u=Object(j.a)(l,2),b=u[0],d=u[1],f=bt((function(e){return console.log("notif",e)||p(e)})),m=Object(j.a)(f,3),h=m[0],p=m[1],g=m[2],v=Object(a.useState)(),x=Object(j.a)(v,2),C=x[0],y=x[1],N=Object(a.useState)(),w=Object(j.a)(N,2),k=w[0],S=w[1];return Object(a.useEffect)((function(){n&&function(e){return O("group/".concat(encodeURI(e)))}(n).then((function(e){return d(e.data.doc)}))}),[n,s]),Object(a.useEffect)((function(){S(b&&"public"===b.privacy||h&&(h.following||h.owned))}),[b,h]),Object(a.useEffect)((function(){s&&b&&p(b._id)}),[s,b]),Object(c.jsx)("div",{className:vt({outlined:r}),children:b?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:vt("left"),children:[i?Object(c.jsx)(pe,{type:"link",className:vt("name"),to:k?mt({group:b.name}):null,label:"#".concat(b.name),target:"_blank",disabled:!k}):Object(c.jsx)(de,{className:vt("name"),themed:!0,children:b.name}),Object(c.jsxs)("div",{className:vt("members"),children:["".concat(b.members," member").concat(1===b.members?"":"s"),"private"===b.privacy&&Object(c.jsx)(me,{icon:"Lock",title:"This is a private group"})]})]}),Object(c.jsxs)("div",{className:vt("right"),children:[h&&!o&&Object(c.jsx)(pe,{className:vt("join"),label:h.owned?"Owner":h.request?"Requested!":h.following?"Joined!":"public"===b.privacy?"Join":"Request",title:"private"===b.privacy&&"This is a private group",disabled:h.following||h.request||h.owned,outlined:!h.following,onClick:function(){return g(h.following,b._id)}}),h&&(h.following||h.owned)&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(ke,{title:"Settings",icon:"Settings",closeOnSelect:!0,items:h.owned?[{label:"Edit group",onClick:function(){return y(!0)}},{label:"Delete group"}]:[{label:"Leave group"}]}),Object(c.jsx)(_t,{open:C,onClose:y,data:b})]})]})]}):"loading..."})},Ct=K("separator"),yt=function(){var e=le().theme;return Object(c.jsx)("span",{className:J(Ct("separator"),M({borderRight:"1px solid ".concat(G(e.primary,e.primary,10))}))})},Nt=K("tabview"),wt=function(e){var t=e.className,n=e.tabs,r=e.defaultTab,o=e.content,i=Object(a.useState)(r||0),s=Object(j.a)(i,2),l=s[0],b=s[1];return Object(c.jsxs)("div",{className:J(Nt(),t),children:[Object(c.jsx)("div",{className:Nt("header"),children:n.map((function(e,t){var a=e.className,r=Object(V.a)(e,["className"]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(pe,Object(u.a)({className:J(Nt("label"),a),underline:l===t,onClick:function(){return b(t)}},r),t),t!==n.length-1&&Object(c.jsx)(yt,{})]})}))}),o&&o[l]?o[l]():Object(c.jsx)("div",{})]})},kt=K("avatar"),St=function(e){var t=e.size,n=e.user,r=e.theme,o=e.preview,i=e.nolink,l=U().user,b=n.display_name,d=n.username,f=n.avatar,O=n.theme,m=void 0===O?r:O,h=ut(d),p=Object(j.a)(h,3),g=p[0],v=p[1],x=p[2],C=function(e){var t=Object.assign({},e);return i?Object(c.jsx)("div",Object(u.a)({},t)):Object(c.jsx)(s.b,Object(u.a)({to:n&&!o&&ft(d)},t))},y=function(){return null==f?Object(c.jsx)(C,{className:J(kt("square"),M({color:G(m.primary),borderColor:G(m.primary,m.primary,20),backgroundColor:m.primary})),children:b.toUpperCase().slice(0,2)}):Object(c.jsx)(C,{className:J(kt("image"),M({backgroundImage:f&&"url(".concat(f,")")}))})};return Object(a.useEffect)((function(){"full"===t&&d&&x(d)}),[t,d]),"full"===t?Object(c.jsxs)(Le,{className:kt({size:t}),color:m.primary,children:[Object(c.jsx)(y,{}),n.display_name,l&&l.username!==d?Object(c.jsx)(pe,{className:M({height:40}),label:g?"Unfollow":"Follow",onClick:function(){return v(d)},outlined:!0}):Object(c.jsx)("div",{className:M({width:50})})]}):Object(c.jsx)("div",{className:kt({size:t}),title:b,children:Object(c.jsx)(y,{})})},Et=K("groupeditmodal"),_t=function(e){var t=e.data,n=e.withSearch,a=Object(V.a)(e,["data","withSearch"]),r=Object(l.g)(),o=gt(),i=Object(j.a)(o,2),s=i[0],b=i[1],d=S((function(e){return P(e).then((function(e){return e.data.docs}))})),f=Object(j.a)(d,2),O=f[0],m=f[1],p=function(){return Object(c.jsx)(Me,{className:Et("form"),data:t,onSave:function(e){return t?(n=e,h("group/update/".concat(n._id),n,{withCredentials:!0})).then((function(){return r.go(0)})):function(e){return h("group/create",e,{withCredentials:!0})}(e).then((function(){return r.go(0)}));var n},children:function(e){var n=e.data,a=e.setField,r=e.Input,o=e.Select,i=e.SubmitButton,s=e.Group;return Object(c.jsxs)(s,{title:t?"Edit group":"Create group",children:[Object(c.jsx)(r,{label:"Name",name:"name",defaultValue:n.name}),Object(c.jsx)(lt,{rows:"10",cols:"40",placeholder:"Description (optional)",defaultValue:n.description,onChange:function(e){return a("description",e.target.value)}}),Object(c.jsx)(o,{name:"privacy",defaultValue:n.privacy,items:["public","private"].map((function(e){return{label:(t=e,t.replace(/^\w/,(function(e){return e.toUpperCase()}))),value:e};var t}))}),Object(c.jsx)(i,{label:t?"Save":"Create",outlined:!0})]})}})};return Object(c.jsx)($e,Object(u.a)(Object(u.a)({className:Et(),closeButton:!0},a),{},{children:n?Object(c.jsx)(wt,{tabs:[{label:"Find group"},{label:"Find user"},{label:"New group"}],content:[function(){return Object(c.jsxs)("div",{className:Et("search_container"),children:[Object(c.jsx)(De,{width:"100%",placeholder:"search by name or enter invite code...",onSubmit:b,submitIcon:"Search",noWrap:!0}),s&&Object(c.jsx)("div",{children:s.map((function(e){return Object(c.jsx)(xt,{data:e,outlined:!0,linked:!0},e._id)}))})]})},function(){return Object(c.jsxs)("div",{className:Et("search_container"),children:[Object(c.jsx)(De,{width:"100%",placeholder:"search by username...",onSubmit:m,submitIcon:"Search",noWrap:!0}),O&&Object(c.jsx)("div",{children:O.map((function(e){return Object(c.jsx)(St,{user:e,size:"full"},e._id)}))})]})},function(){return Object(c.jsx)(p,{})}]}):Object(c.jsx)(p,{})}))},Ft=n(293),Dt=n(302);function At(){var e=Object(Ft.a)(["\n              background-color: "," !important;\n              border: 1px solid ",";\n              box-shadow: 0px 0px 1px ",";\n            "]);return At=function(){return e},e}var Bt=K("colorpicker"),zt=function(e){var t=e.defaultValue,n=e.name,r=e.onChange,o=e.title,i=e.className,s=e.label,l=Object(a.useState)(t),u=Object(j.a)(l,2),b=u[0],d=u[1],f=Object(a.useState)(),O=Object(j.a)(f,2),m=O[0],h=O[1],p=Object(a.useState)(),g=Object(j.a)(p,2),v=g[0],x=g[1],C=Object(a.useRef)(),y=Object(a.useRef)(),N=function(e){return C.current&&C.current.contains(e.target)?null:h(!1)};return Object(a.useEffect)((function(){return document.addEventListener("mousedown",N),function(){return document.removeEventListener("mousedown",N)}}),[]),Object(a.useEffect)((function(){if(C.current&&y.current){var e=C.current.getBoundingClientRect().left,t=C.current.getBoundingClientRect().bottom,n=y.current.getBoundingClientRect().width,c=y.current.getBoundingClientRect().height,a=window.innerWidth,r=window.innerHeight;window.pageYOffset;e+n>a&&(e+=a-(e+n)),t+c>r&&(t+=r-(t+c)),x([e,t])}}),[m,C,y]),Object(c.jsxs)("div",{className:J(Bt(),i),ref:C,children:[s&&Object(c.jsx)(de,{className:Bt("label"),children:s}),Object(c.jsx)(je.a,{title:o||"Choose a color",disableFocusListener:!o,disableHoverListener:!o,disableTouchListener:!o,placement:"top",children:Object(c.jsx)("button",{className:J(Bt("trigger"),M(At(),b,G(b),G(b))),onClick:function(){return h(!m)}})},"tooltip"),m&&Object(c.jsx)("div",{ref:y,className:J(Bt("picker"),M({position:"fixed !important",top:v?v[1]:-1e7,left:v?v[0]:-1e7})),children:Object(c.jsx)(Dt.a,{name:n,color:b,colors:["#ffcdd2","#ef9a9a","#e57373","#E1BEE7","#CE93D8","#BA68C8","#BBDEFB","#90CAF9","#64B5F6","#C8E6C9","#A5D6A7","#81C784","#FFF9C4","#FFF59D","#FFF176","#FFE0B2","#FFCC80","#FFB74D","#D7CCC8","#BCAAA4","#A1887F","#E0E0E0","#BDBDBD","#9E9E9E"],onChangeComplete:function(e){d(e.hex),r({target:{name:n,value:e.hex}})}})})]})},It=K("settingsmodal"),Lt=function(e){e.data;var t=e.withSearch,n=Object(V.a)(e,["data","withSearch"]),r=U().user,o=Object(a.useState)(!t),i=Object(j.a)(o,2),s=(i[0],i[1],Object(l.g)(),L((function(){return r&&f(r.username)}))),b=Object(j.a)(s,3),d=b[0],f=b[1],O=b[2];return Object(a.useEffect)((function(){r&&f(r.username)}),[r]),Object(c.jsx)($e,Object(u.a)(Object(u.a)({className:It(),closeButton:!0},n),{},{children:r&&d&&Object(c.jsxs)(He,{title:"Appearance",children:[Object(c.jsx)(zt,{defaultValue:d.primary,title:"Choose a primary color",label:"Primary color",onChange:function(e){return O({primary:e.target.value})}},"color1"),Object(c.jsx)(zt,{defaultValue:d.secondary,title:"Choose a secondary color",label:"Secondary color",onChange:function(e){return O({secondary:e.target.value})}},"color2"),Object(c.jsx)(De,{defaultValue:r.display_name,placeholder:"Display name",submitIcon:"Check",onSubmit:function(e){return h("user/displayname",{name:e},{withCredentials:!0})}})]})}))},Rt=n(687),Pt=K("header"),Tt=function(){var e=U(),t=e.user,n=e.signOut,r=Object(a.useState)(!1),o=Object(j.a)(r,2),i=o[0],s=o[1],l=dt(),u=Object(j.a)(l,4),b=u[0],d=u[1],f=(u[2],u[3]),O=Object(a.useState)(),m=Object(j.a)(O,2),h=m[0],p=m[1],g=Object(a.useState)(),v=Object(j.a)(g,2),x=v[0],C=v[1],y="secondary",N="primary";return Object(a.useEffect)((function(){t?d():f()}),[t]),Object(c.jsxs)("header",{className:Pt(),children:[Object(c.jsxs)(Rt.a,{className:Pt("inner"),maxWidth:"md",children:[Object(c.jsxs)("div",{className:Pt("left"),children:[Object(c.jsx)(pe,{className:Pt("button"),label:"All",type:"button",to:t?mt():"/",color:y,bg:N}),b&&b.map((function(e){var t=e.name;return Object(c.jsx)(pe,{className:Pt("button"),label:"#".concat(t),to:mt({group:t}),color:y,bg:N},t)})),t&&Object(c.jsx)(pe,{icon:"Add",title:"Create group",onClick:function(){return p(!0)},color:y,bg:N})]}),Object(c.jsx)("div",{className:Pt("right"),children:null!=t?Object(c.jsx)(ke,{label:t.display_name,items:[{label:"My stuff",to:ft(t.username)},{label:"Settings",onClick:function(){return C(!0)}},{label:"Log out",onClick:n}],closeOnSelect:!0,color:y,bg:N}):[Object(c.jsx)(pe,{className:Pt("button"),label:"Login",onClick:function(){return s(!0)},color:y,bg:y},"login"),Object(c.jsx)(pe,{className:Pt("button"),label:"Signup",onClick:function(){return s("signup")},color:y,bg:y},"signup")]})]}),Object(c.jsxs)(ue,{children:[Object(c.jsx)(Ge,{open:!!i,signUp:"signup"===i,onClose:function(){return s(!1)}}),t&&Object(c.jsx)(_t,{withSearch:!0,open:h,onClose:p}),t&&Object(c.jsx)(Lt,{open:x,onClose:C})]})]})},Ut=function(e){var t=e.children;return Object(c.jsx)("title",{children:t?"".concat(t," | Squeakr"):"Squeakr"})},qt=K("page"),Vt=function(e){var t=e.className,n=e.children,a=e.title,r=e.theme,o=Object(V.a)(e,["className","children","title","theme"]);return Object(c.jsxs)("div",Object(u.a)(Object(u.a)({className:J(qt(),M({backgroundColor:r&&r.primary}),t)},o),{},{children:[Object(c.jsxs)(ue,{theme:r,children:[Object(c.jsx)(Ut,{children:a}),Object(c.jsx)(Tt,{})]}),n]}))},Wt=K("body"),Ht=function(e){var t=e.children,n=e.div,a=e.size,r=e.fixed,o=e.className;return n?Object(c.jsx)("div",{className:J(Wt(),o),children:t}):Object(c.jsx)(Rt.a,{maxWidth:!r&&(a||"md"),className:J(Wt(),o),children:t})},Mt=K("card"),Jt=function(e){var t=e.color,n=e.bgColor,a=e.className,r=e.thickness,o=e.to,i=Object(V.a)(e,["color","bgColor","className","thickness","to"]),l=J(Mt(),t&&M({border:"1px solid ".concat(G(n,t,30)),boxShadow:Array.from({length:r||2},(function(e,c){return"".concat(c,"px ").concat(c,"px 0px 0px ").concat(G(n,t,10))})).join(","),background:n,cursor:o&&"pointer"}),a);return o?Object(c.jsx)(s.b,Object(u.a)({to:o,className:l},i)):Object(c.jsx)("div",Object(u.a)({className:l},i))},Kt=n(298),Gt=n.n(Kt),Yt=(n(551),K("video")),$t=function(e){var t=e.source,n=(e.type,e.className),a=e.preview;return Object(c.jsx)("video",{controls:!a,className:J(Yt({preview:!!a}),n),children:t&&Object(c.jsx)("source",{src:t})})},Qt=n(300),Xt=n.n(Qt),Zt=n(168),en=/(.*)(https?:\/\/\S+)(.*)/i,tn=/\/api\/file\/img\/\w+/i,nn=K("link"),cn={},an={},rn=function(e){var t=e.newtab,n=e.className,r=e.href,o=e.preview,i=e.alt,s=e.children,l=e.bg,b=void 0===l?"secondary":l,d=e.color,f=void 0===d?"primary":d,O=e.amt,h=void 0===O?20:O,p=le().getColor,g=Object(a.useState)(),v=Object(j.a)(g,2),x=v[0],C=v[1],y=Object(a.useState)(),N=Object(j.a)(y,2),w=N[0],k=N[1],S=Object(a.useState)(),E=Object(j.a)(S,2),_=E[0],F=E[1],D=Object(a.useState)(),A=Object(j.a)(D,2),B=A[0],z=A[1],I=Object(a.useState)(),L=Object(j.a)(I,2),R=L[0],P=L[1];return Object(a.useEffect)((function(){var e,t,n=!1;if("link"===R){var c=o?cn[r]:an[r];c?(k(c),C(c.data)):(e=r,t={preview:o},m("util/scrape",Object(u.a)({url:e},t))).then((function(e){n||(z(r),k(e.data),C(e.data.data),o?cn[r]=e.data:an[r]=e.data)})).finally((function(){return!n&&F(!0)}))}else F(!0);return function(){n=!0}}),[cn,an,R,r,B]),Object(a.useEffect)((function(){return function(){var e=document.getElementById("scripts-".concat(encodeURI(r)));e&&e.parentElement.removeChild(e)}}),[]),Object(a.useEffect)((function(){if(r){var e=Object(Zt.lookup)(r),t=en.test(r);tn.test(r)?P("image"):e?e.startsWith("video")?P("video"):e.startsWith("image")&&P("image"):P(t||t?"link":"other")}}),[r]),_||R?x&&w?Object(c.jsx)("div",{className:J(nn({preview:o,thumbnail:!!x.thumbnail_url}),M({backgroundImage:o&&x.thumbnail_url&&"url(".concat(x.thumbnail_url,")"),width:x.width,height:x.height,maxHeight:o&&150}),n),children:o&&!w.render_preview?Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(de,{themed:!0,className:nn("title"),children:x.title})}):x.html&&Xt()(x.html,{transform:function(e){if("script"===e.type){var t=document.getElementById("scripts-".concat(encodeURI(r)));t||((t=document.createElement("div")).id="scripts-".concat(encodeURI(r)),document.head.appendChild(t));var n=document.createElement("script");n.src=e.attribs.src,t.appendChild(n)}}})}):"video"===R?Object(c.jsx)($t,{className:nn("video"),source:r,type:R,preview:o}):"image"===R?Object(c.jsx)("img",{className:nn("image"),src:r,alt:i||r,loading:"lazy"}):"link"===R?Object(c.jsx)("a",{className:J(nn(),M({color:p(f,b,h)}),n),href:r,alt:i,rel:t?"noreferrer":null,target:t?"_blank":null,children:s||r}):r:Object(c.jsx)("div",{className:J(nn({loading:!0}),M({backgroundColor:p("secondary","secondary")}))})},on=(n(614),K("markdown")),sn=function(e){var t=e.content,n=e.size,a=e.preview,r=e.className,o=le().theme,i={text:function(e){return Object(c.jsx)(rn,Object(u.a)({className:on("text"),color:"primary",newtab:!0,preview:a,href:e.value},e))},image:function(e){var t=e.src,n=Object(V.a)(e,["src"]);return Object(c.jsx)(rn,Object(u.a)({className:on("image"),color:"primary",preview:a,newtab:!0,href:t,scrape:!0},n))},link:function(e){return Object(c.jsx)(rn,Object(u.a)({className:on("link"),color:"primary",preview:a,newtab:!0,scrape:!0},e))}};return Object(c.jsx)(Gt.a,{className:J(on({size:n||"full"}),M({"&, & > *":{color:G(o.secondary,o.secondary,65)},"& h1":{color:G(o.secondary,o.secondary,60),backgroundColor:G(o.secondary,o.secondary,20)},"& a, & .link":{color:Y(o.primary,-30),textShadow:"0px 0px 1px ".concat(Y(o.primary,-30))}}),r),renderers:i,children:t.replace(/(?:\r\n|\r|\n)/gi,"\n\n")})},ln=function(e){return m("post/add",e,{withCredentials:!0})},un=function(e){return p("post/update",e,{withCredentials:!0})},jn=function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.apply(void 0,["delete"].concat(t))}("post/delete",{data:{id:e},withCredentials:!0})},bn=function(e,t){return O("post/".concat(e),t).then((function(e){return e.data.doc}))},dn=function(e,t){return m("post/query",e,Object(u.a)(Object(u.a)({},t),{},{withCredentials:!0}))},fn=K("postviewmodal"),On=function(e){e.data;var t=e.id,n=e.theme,a=e.onDeletePost,r=Object(V.a)(e,["data","id","theme","onDeletePost"]);return Object(c.jsx)($e,Object(u.a)(Object(u.a)({className:fn()},r),{},{closeButton:!0,transparent:!0,children:Object(c.jsx)(Vn,{id:t,theme:n,size:"full",onDelete:a})}))},mn=n(688),hn=K("tag"),pn=(Object(mn.a)({colorPrimary:{backgroundColor:function(e){return e.color}}}),function(e){var t=e.value,n=e.request,a=e.className,r=e.color,o=e.username,i=e.size,s=e.nolink,l=(e.children,e.clickable),j=e.onDelete,b=e.onClick,d=Object(V.a)(e,["value","request","className","color","username","size","nolink","children","clickable","onDelete","onClick"]),f=le().theme[r||"primary"]||r,O=new H.a(f),m=function(e){return s?Object(c.jsx)("div",Object(u.a)({},e)):Object(c.jsx)("a",Object(u.a)({},e))};return Object(c.jsxs)(m,Object(u.a)(Object(u.a)({className:J(hn({size:i||"medium",clickable:b||l||!s,request:n}),M({color:G(f,f,50),backgroundColor:f,"&:hover, &:focus":(b||l||!s)&&{backgroundColor:O.isLight()?O.darken(20).toString():O.brighten(20).toString()}}),a),href:s?null:ht({username:o,tags:[t]}),onClick:b,tabIndex:"0",onKeyDown:function(e){if("Enter"===e.key)return b&&b(e),!1}},d),{},{children:[n&&Object(c.jsx)(me,{className:hn("more"),icon:"MoreHoriz"}),Object(c.jsx)("div",{className:hn("value"),children:t}),j&&Object(c.jsx)(me,{className:J(hn("delete"),M({"&:hover, &:focus":{backgroundColor:O.isLight()?O.darken(20).toString():O.brighten(20).toString()}})),icon:"Close",onClick:j})]}))}),gn=K("taginput"),vn=Object(a.forwardRef)((function(e,t){var n=e.className,r=e.onChange,o=e.floatSuggestions,i=e.size,s=e.nolimit,l=e.defaultValue,b=e.width,d=gt(),f=Object(j.a)(d,4),O=f[0],m=f[1],h=(f[2],f[3]),p=Object(a.useState)(l||[]),g=Object(j.a)(p,2),v=g[0],x=g[1],C=Object(a.useState)(""),y=Object(j.a)(C,2),N=y[0],w=y[1],k=Object(a.useRef)();Object(a.useEffect)((function(){r&&r(v)}),[v]),Object(a.useEffect)((function(){N&&N.length>0&&m(N)}),[N]);var S=Object(a.useCallback)((function(e,t){k.current&&(k.current.value="",w(""),x([].concat(Object(Z.a)(v.filter((function(t){return t.value!==e}))),[{value:e,request:t}])),h(),k.current.focus())}),[k,v,h]);return Object(c.jsxs)("div",{className:J(gn({floatSuggestions:o}),n),ref:t,children:[Object(c.jsx)(De,{ref:k,className:J(gn("input"),M({maxWidth:b})),placeholder:"Groups (optional)",onChange:function(e){return w(e.target.value.trim())},disabled:!s&&v.length>=3,showinput:s||v.length<3,size:i,children:v.map((function(e){return Object(c.jsx)(pn,{className:gn("tag"),value:e.value,onDelete:function(){return x(v.filter((function(t){return t.value!==e.value})))},request:e.request,size:"small",nolink:!0},e.value)}))}),O&&O.length>0&&Object(c.jsx)("div",{className:gn("suggestions"),children:O&&O.map((function(e){return Object(a.createElement)(pn,Object(u.a)(Object(u.a)({},e),{},{key:e._id,onClick:function(){S(e.value)},size:"small",nolink:!0}))}))})]})})),xn=K("posteditmodal"),Cn=function(e){var t=e.data,n=Object(V.a)(e,["data"]),r=U().user,o=Object(l.g)(),i=Object(a.useState)(),s=Object(j.a)(i,2),b=s[0],d=s[1],f=Object(a.useState)(),O=Object(j.a)(f,2),m=O[0],h=O[1];Object(a.useEffect)((function(){}),[b]);var p=t&&t._id;return Object(c.jsx)($e,Object(u.a)(Object(u.a)({className:xn(),closeButton:!0},n),{},{children:Object(c.jsx)(Me,{className:xn("form"),data:t,onChange:d,onSave:function(e){var t=Object(u.a)({},e);t.tags&&(t.tags=t.tags.map((function(e){return e.value}))),p?un(t).then((function(){return o.go(0)})):ln(t).then((function(){return o.go(0)}))},children:function(e){e.data;var n=e.setField,a=(e.Checkbox,e.SubmitButton);return[Object(c.jsxs)("div",{className:xn("header"),children:[Object(c.jsx)("div",{className:xn("title"),children:"".concat(p?"Edit":"New"," Post")}),Object(c.jsx)(qe,{label:"preview",onChange:h})]},"header"),m&&r&&Object(c.jsx)("div",{className:xn("preview_container"),children:Object(c.jsxs)(ue,{username:r.username,children:[Object(c.jsx)(Vn,{size:"small",preview:Object(u.a)(Object(u.a)({},b),{},{date_created:Date.now()})},"preview"),Object(c.jsx)(Vn,{size:"full",preview:Object(u.a)(Object(u.a)({},b),{},{date_created:Date.now()})})]})},"prvw"),Object(c.jsxs)("div",{className:xn("body",{hide:m&&!!r}),children:[Object(c.jsx)(lt,{name:"content",placeholder:"Add text/video/image here...",rows:"20",cols:"50",onChange:function(e){return n("content",e.target.value)},defaultValue:t&&t.content,acceptFiles:!0,required:!0}),Object(c.jsx)(vn,{className:xn("taginput"),onChange:function(e){return n("tags",e)},defaultValue:t&&t.tags}),Object(c.jsx)(a,{label:p?"Save":"Post",outlined:!0})]},"body")]}})}))},yn=K("confirmdialog"),Nn=function(e){var t=e.open,n=e.prompt,a=e.onYes,r=e.onNo,o=e.onClose;return Object(c.jsxs)(_e,{className:yn(),onClose:o,open:t,children:[Object(c.jsx)("div",{className:yn("prompt"),children:n}),Object(c.jsxs)("div",{className:yn("choices"),children:[Object(c.jsx)(pe,{icon:"Check",onClick:function(){a&&a(),o&&o()}}),Object(c.jsx)(pe,{icon:"Close",onClick:function(){r&&r(),o&&o()}})]})]})},wn=K("search"),kn=/[\s\w]+(:)/,Sn=function(e){var t=e.type,n=e.label,r=e.icon,o=e.isPlaintext,i=e.onChange,s=e.onDelete,l=e.onSelect,u=e.onCancel,j=e.suggestions,b=le().getColor,d=Object(a.useRef)();return Object(a.useEffect)((function(){d.current&&d.current.focus()}),[d]),Object(c.jsxs)("span",{className:J(wn("block"),M({backgroundColor:b()})),children:[r&&Object(c.jsx)(me,{className:M({marginLeft:4,color:b(null,null,10)}),icon:r}),Object(c.jsx)(de,{className:wn("block_label"),bg:"secondary",amt:-10,title:t,themed:!0,children:"".concat(r?"":t+": ").concat(n||"")}),!n&&Object(c.jsx)(De,{ref:d,size:"small",onChange:i,onKeyDown:function(e){var t=e.key;o&&"Enter"===t&&l({icon:"FormatQuote",label:'"'.concat(e.target.value,'"'),value:e.target.value,plaintext:!0}),"Escape"===t&&u()}}),Object(c.jsx)(pe,{icon:"Close",color:"secondary",bg:"secondary",onClick:function(e){return s(e)},tabIndex:-1}),j&&Object(c.jsx)("div",{className:wn("suggestions"),children:j.map((function(e){return Object(c.jsx)(pe,{className:wn("suggest"),label:e.label,onClick:function(){return l(e)},amt:30},e.value)}))})]})},En=function(e){var t=e.active,n=e.blocks,r=e.suggestion,o=e.placeholder,i=e.className,s=e.onSearch,l=e.onChange,u=e.defaultValue,b=e.onOpen,d=e.onClose,f=Object(a.useState)(t),O=Object(j.a)(f,2),m=O[0],h=O[1],p=Object(a.useState)([]),g=Object(j.a)(p,2),v=g[0],x=g[1],C=Object(a.useState)(u||[]),y=Object(j.a)(C,2),N=y[0],w=y[1],k=Object(a.useState)(""),S=Object(j.a)(k,2),E=S[0],_=S[1],F=Object(a.useState)(),D=Object(j.a)(F,2),A=D[0],B=D[1],z=Object(a.useState)(),I=Object(j.a)(z,2),L=I[0],R=I[1],P=Object(a.useRef)(),T=function(){_(""),x([])};return Object(a.useEffect)((function(){m?b&&b():d&&d()}),[m]),Object(a.useEffect)((function(){l&&l(N)}),[N]),m||t?Object(c.jsxs)("div",{className:J(wn(),M({}),i),children:[!t&&Object(c.jsx)(pe,{icon:"ArrowBack",title:"Cancel",className:M({marginLeft:3}),onClick:function(){return T()||h(!1)||s([])}}),Object(c.jsxs)(De,{ref:P,className:wn("input"),placeholder:o,value:E,dirty:E.length>0||v.length>0,onChange:function(e){_(e.target.value),n&&n.forEach((function(t){var n=e.target.value.match(t||kn);if(n){var c=n.slice(1).join(".");v.some((function(e){return e===c}))||(x([].concat(Object(Z.a)(v),[c])),_(""))}}))},onKeyDown:function(e){"Backspace"!==e.key||E&&0!==E.length||(v.length>0?x(v.slice(0,-1)):N.length>0&&w(N.slice(0,-1)))},onClear:t&&T,submitIcon:!t&&"Search",onSubmit:t?null:function(){return s(N)},children:[N.map((function(e){return Object(c.jsx)(Sn,{label:e.label,icon:e.icon,type:e.type,onDelete:function(){return w(N.filter((function(t){return!(t.type===e.type&&t.value===e.value)})))}},"fullterm-".concat(e.value))})),v.map((function(e,t){return Object(c.jsx)(Sn,{type:e,isPlaintext:!r||!r[e],onCancel:function(){x(v.filter((function(t){return t!==e}))),P.current&&P.current.focus()},onSelect:function(t){t.type=e,N.some((function(n){return n.type===e&&n.value===t.value}))||(w([].concat(Object(Z.a)(N),[t])),x(v.filter((function(e){return e!==t.type}))),P.current&&P.current.focus())},onDelete:function(){return x(v.filter((function(e,n){return n!==t})))},onChange:function(t){r&&r[e]?r[e](B,t.target.value):A&&B(),R(e)},suggestions:L===e&&A},"term-".concat(e))}))]})]}):Object(c.jsx)("div",{className:J(wn(),i),children:Object(c.jsx)(pe,{icon:"Search",title:"Search",onClick:function(){return h(!0)}})})},_n=function(e){return{icon:"Group",type:"group",label:e,value:e}},Fn=function(e){return{icon:"AlternateEmail",type:"user",label:e.display_name,value:e.username}},Dn=function(e,t){P(t).then((function(t){return e(t.data.docs.map((function(e){return Fn(e)})))}))},An=function(e,t){e(["video","image","youtube"].filter((function(e){return e.includes(t)})).map((function(e){return{icon:"PermMedia",type:"media",label:t=e,value:t};var t})))},Bn=function(e,t){pt(t).then((function(t){return e(t.data.docs.map((function(e){return _n(e.name)})))}))},zn=K("postinput"),In=function(e){var t=e.defaultValue,n=e.onCancel,r=Object(a.useState)(),o=Object(j.a)(r,2),i=o[0],s=o[1],l=t&&t._id;return Object(c.jsx)(Le,{className:zn({active:i}),onClick:function(e){s(!0)},themed:!0,children:i||l?Object(c.jsx)(Me,{className:zn("form"),data:t,onSave:function(e){var t=Object(u.a)({},e);l?un(t):ln(t),s(!1),n&&n()},children:function(e){e.data;var a=e.setField,r=(e.setData,e.Checkbox,e.SubmitButton);return[Object(c.jsxs)("div",{className:zn("body"),children:[Object(c.jsx)(lt,{name:"content",placeholder:"Add text/video/image here...",rows:"4",cols:"50",onChange:function(e){return a("content",e.target.value)},defaultValue:t&&t.content,acceptFiles:!0,required:!0}),Object(c.jsx)(En,{className:zn("search"),placeholder:"user: / group:",blocks:[/\b(user|group):/i],suggestion:{user:Dn,group:Bn},onChange:function(e){return a("tags",e)},defaultValue:t&&[].concat(Object(Z.a)(t.group?t.group.map((function(e){return _n(e.name)})):[]),Object(Z.a)(t.mention?t.mention.map((function(e){return Fn(e)})):[])),active:!0}),Object(c.jsxs)("div",{className:zn("footer"),children:[Object(c.jsx)(r,{label:l?"Save":"Post",outlined:!0}),Object(c.jsx)(pe,{label:"Cancel",onClick:function(e){s(),n&&n(),e.stopPropagation()},outlined:!0})]})]},"body")]}}):Object(c.jsx)(de,{className:zn("placeholder"),themed:!0,children:"Post something here..."})})},Ln=K("commentinput"),Rn=function(e){var t=e.postid,n=e.commentid,r=e.defaultValue,o=e.onCancel,i=e.active,s=Object(a.useState)(i),l=Object(j.a)(s,2),b=l[0],d=l[1],f=r&&r._id;return Object(c.jsx)(Le,{className:Ln({active:b}),onClick:function(e){d(!0)},children:b||f?Object(c.jsx)(Me,{className:Ln("form"),data:r,onSave:function(e){var c=Object(u.a)(Object(u.a)({},e),{},{post:t,comment:n});f?p("comment/update",c,{withCredentials:!0}):function(e){m("comment/add",e,{withCredentials:!0})}(c),d(!1),o&&o()},children:function(e){e.data;var t=e.setField,a=(e.setData,e.Checkbox,e.SubmitButton);return[Object(c.jsxs)("div",{className:Ln("body"),children:[Object(c.jsx)(lt,{name:"content",placeholder:"Add text/video/image here...",rows:"2",cols:"50",onChange:function(e){return t("content",e.target.value)},defaultValue:r&&r.content,acceptFiles:!0,required:!0}),Object(c.jsxs)("div",{className:Ln("footer"),children:[Object(c.jsx)(a,{label:f?"Save":n?"Reply":"Post",outlined:!0}),Object(c.jsx)(pe,{label:"Cancel",onClick:function(e){d(),o&&o(),e.stopPropagation()},outlined:!0})]})]},"body")]}}):Object(c.jsx)(de,{className:Ln("placeholder"),themed:!0,children:"Add a comment..."})})},Pn=K("comment"),Tn=function e(t){var n=t.id,r=t.data,o=t.showReplies,i=Object(a.useState)(r),s=Object(j.a)(i,2),l=s[0],u=s[1],b=Object(a.useState)(),d=Object(j.a)(b,2),f=d[0],m=d[1],h=Object(a.useState)(o),p=Object(j.a)(h,2),g=p[0],v=p[1],x=U().user;return Object(a.useEffect)((function(){n&&!r&&function(e){return O("comment/".concat(e))}(n).then((function(e){return u(e.data.doc)}))}),[n,r]),l?Object(c.jsxs)("div",{className:Pn(),children:[Object(c.jsxs)("div",{className:Pn("main"),children:[Object(c.jsx)(St,{user:l.user,size:"small"}),Object(c.jsx)(sn,{className:Pn("markdown"),content:l.content,size:"full"}),x&&Object(c.jsx)(pe,{className:Pn("reply"),icon:"Add",onClick:function(){return m(!0)}})]}),f?Object(c.jsx)(Rn,{commentid:l._id,active:!0,onCancel:m}):Object(c.jsxs)("div",{className:Pn("replies"),children:[l.comment.length>0&&Object(c.jsx)(de,{className:Pn("count"),amt:40,themed:!0,onClick:function(){return v(!g)},children:g?"hide comment".concat(B(l.comment.length,"s")):"".concat(l.comment.length," comment").concat(B(l.comment.length,"s"))}),g&&l.comment.map((function(t){return Object(c.jsx)(e,{id:t},t)}))]})]}):"..."},Un=function(e,t){return t?h("reaction/post",{post:e,icon:t},{withCredentials:!0}):O("reaction/post/".concat(e))},qn=K("post"),Vn=Object(a.forwardRef)((function(e,t){var n=e.id,r=e.size,o=e.preview,i=e.viewing,s=e.truncate,b=e.onClick,d=e.className,f=e.onDelete,O=le(),m=O.theme,p=O.setTheme,g=O.getColor,v=U().user,x=Object(a.useState)(),C=Object(j.a)(x,2),N=C[0],w=C[1],k=Object(a.useState)(),S=Object(j.a)(k,2),E=S[0],_=S[1],F=Object(a.useState)(),D=Object(j.a)(F,2),A=D[0],B=D[1],z=Object(a.useState)(i),I=Object(j.a)(z,2),L=(I[0],I[1]),R=Object(a.useState)([]),P=Object(j.a)(R,2),T=P[0],q=(P[1],Object(a.useState)("text")),V=Object(j.a)(q,2),W=V[0],H=V[1],K=Object(a.useState)(),G=Object(j.a)(K,2),Q=G[0],X=G[1],Z=Object(a.useState)(!1),ee=Object(j.a)(Z,2),te=ee[0],ne=ee[1],ce=Object(a.useState)(),ae=Object(j.a)(ce,2),re=ae[0],oe=ae[1],ie=Object(a.useState)(),je=Object(j.a)(ie,2),be=je[0],fe=je[1],Oe=new URLSearchParams(Object(l.h)().search),he=(Object(l.g)(),function(e,t){return new Date(e).toLocaleString(navigator.language,{dateStyle:"short",timeStyle:t&&"short",hour12:!0})}),ge=function(e){return bn(e||n).then(w)},ve=Object(a.useCallback)((function(e){(e||N&&N._id)&&Un(e||N._id).then((function(e){return fe(e.docs)}))}),[N]);return y("post/update",n,(function(){return ge(n)})),y("comment/add-post",n,(function(){return ge(n)})),y("reaction/post-add",n,(function(){return ve(n)})),y("reaction/post-delete",n,(function(){return ve(n)})),Object(a.useEffect)((function(){o?w(Object(u.a)(Object(u.a)({},o),{},{user:v})):n&&(ge(n),ve(n))}),[n,o]),Object(a.useEffect)((function(){N&&Oe&&"full"!==r&&Oe.get("post")===N._id&&L(!0)}),[N,Oe,r]),Object(a.useEffect)((function(){N&&(p(N.user.theme),_(he(N.date_created)),B(he(N.date_created,!0)))}),[N]),Object(a.useEffect)((function(){H(T.length>0?T[0].source:"text")}),[T]),Object(a.useEffect)((function(){var e=setTimeout((function(){n&&!Q&&"full"===r&&function(e){h("post/viewed/".concat(e),{},{withCredentials:!0})}(n)}),15e3);return function(){clearTimeout(e)}}),[n,r,Q]),N?Object(c.jsx)("div",{className:J(qn({size:r,type:W}),d),ref:t,children:Object(c.jsxs)(ue,{theme:N.user.theme,children:[Object(c.jsx)(se.Consumer,{children:function(e){var t=e.theme;return Object(c.jsxs)(Jt,{className:qn("card"),color:Y(t.secondary,-50),bgColor:t.secondary,thickness:"small"===r?2:6,onClick:function(){return!o&&b&&b()},to:"small"===r&&!o&&!b&&Ot(N._id),title:"small"===r?"".concat(N.user.display_name," - ").concat(A):"",children:[Q?Object(c.jsx)("div",{className:qn("main"),children:Object(c.jsx)(In,{defaultValue:N,onCancel:X})}):Object(c.jsxs)("div",{className:qn("main"),children:[N.comment.length>0&&"small"===r&&Object(c.jsx)(me,{icon:"Comment",className:J(qn("icon_comment"),M({color:g(N.user.theme.primary)}))}),Object(c.jsx)(St,{user:N.user,preview:o,size:"full"===r?"medium":"small",nolink:"small"===r}),Object(c.jsxs)(Ht,{div:!0,className:qn("content",{blur:N.spoiler&&!te}),fixed:!0,children:[T.length>0&&"small"===r&&Object(c.jsx)("div",{className:J(qn("thumbnail"),M({background:"url(".concat(T[0].thumbnail,")")}))}),N.spoiler&&!te&&Object(c.jsxs)("div",{className:J(qn("spoiler"),M({background:N.spoiler&&!te&&"rgba(".concat($(t.secondary,.8).join(","),")")})),onClick:function(){return ne(!0)},children:["SPOILER",Object(c.jsxs)("span",{children:["click to ","small"===r?"view":"reveal"]})]}),("text"===W||"full"===r)&&Object(c.jsx)(sn,{content:s&&N.content.length>300?N.content.slice(0,300)+"...":N.content,size:r,preview:o||"small"===r}),s&&"full"===r&&N.content.length>300&&Object(c.jsx)(pe,{className:qn("readmore"),bg:"primary",to:Ot(N._id),label:"Read more >>",type:"link"}),N.mention.length>0&&Object(c.jsx)("div",{className:qn("mentions"),children:N.mention.map((function(e){return"small"===r?Object(c.jsx)(de,{className:qn("mention"),amt:60,themed:!0,children:"@".concat(e.display_name)},e._id):Object(c.jsx)(pe,{icon:"AlternateEmail",amt:40,label:e.display_name,to:ft(e.username)},e._id)}))}),N.group.length>0&&Object(c.jsx)("div",{className:qn("mentions"),children:N.group.map((function(e){return"small"===r?Object(c.jsx)(de,{className:qn("mention"),amt:60,themed:!0,children:"#".concat(e.name)},e._id):Object(c.jsx)(pe,{amt:40,label:"#".concat(e.name),to:mt({group:e.name})},e._id)}))})]}),"youtube"===W&&"small"===r&&Object(c.jsx)(me,{className:J(qn("icon"),M({color:"#FF0000"})),icon:"YouTube"})]}),"small"!==r&&Object(c.jsxs)("div",{className:qn("footer"),children:[Object(c.jsx)(de,{className:qn("date"),title:"".concat(N.user.display_name," - ").concat(A),color:"secondary",bg:"primary",amt:30,themed:!0,children:E}),Object(c.jsxs)("div",{className:M({display:"flex"}),children:[!o&&Object(c.jsx)(pe,{icon:"OpenInNew",title:Ot(N._id),to:Ot(N._id),type:"button",onClick:function(){}}),!o&&v&&v._id===N.user._id&&Object(c.jsx)(ke,{icon:"Settings",items:[{label:"Edit",onClick:function(){return X(!0)}},{label:"Delete",onClick:function(){return oe(!0)}}],closeOnSelect:!0},"actions")]}),Object(c.jsx)(Nn,{open:re,prompt:"Are you sure you want to delete this post?",onYes:function(){return jn(n).then((function(){return f()}))},onClose:oe})]})]})}}),"small"!==r&&Object(c.jsxs)(Le,{className:qn("after_post"),children:[Object(c.jsx)("div",{className:qn("reactions"),children:Object(c.jsx)(pe,{icon:"ThumbUpAlt",label:be?be.filter((function(e){return"ThumbUpAlt"===e.icon})).length:0,onClick:function(){return Un(N._id,"ThumbUpAlt")},disabled:!v})}),v&&Object(c.jsx)(Rn,{postid:N._id}),N.comment.length>0&&Object(c.jsx)("div",{className:qn("comments"),children:N.comment.map((function(e){return Object(c.jsx)(Tn,{id:e._id,data:e.data,showReplies:!0},e._id)}))})]})]})}):Object(c.jsx)(Jt,{className:qn({size:r,empty:!0}),color:Y(m.secondary,-70),bgColor:m.secondary,thickness:"small"===r?2:5})})),Wn=n(173),Hn=n.n(Wn),Mn=K("grid"),Jn={350:1,750:2,900:3},Kn=function(e){var t=e.className,n=e.children,a=Object(V.a)(e,["className","children"]);return Object(c.jsx)(Wn.ResponsiveMasonry,{columnsCountBreakPoints:Jn,children:Object(c.jsx)(Hn.a,Object(u.a)(Object(u.a)({className:J(Mn(),t)},a),{},{children:n}))})},Gn=K("postview"),Yn=function(e){var t=e.theme,n=e.className,r=ne("postview"),o=Object(j.a)(r,2),i=o[0],s=o[1],b=ne("postview_ui"),d=(Object(j.a)(b,1)[0],Object(a.useState)({})),f=Object(j.a)(d,2),O=f[0],m=f[1],h=Object(a.useState)([]),p=Object(j.a)(h,2),v=p[0],x=p[1],C=Object(a.useState)(0),N=Object(j.a)(C,2),w=(N[0],N[1],Object(a.useState)()),k=Object(j.a)(w,2),S=k[0],E=k[1],_=Object(a.useState)(""),F=Object(j.a)(_,2),D=F[0],B=F[1],z=Object(a.useState)({}),I=Object(j.a)(z,2),L=I[0],P=I[1],T=Object(l.i)().user,q=Object(a.useState)(),V=Object(j.a)(q,2),W=V[0],H=V[1],K=U().user,G=Object(a.useState)(),Y=Object(j.a)(G,2),$=Y[0],Q=Y[1],X=Object(a.useState)(i.view_type),ee=Object(j.a)(X,2),te=ee[0],ce=ee[1],ae=Object(a.useState)(i.view_type),re=Object(j.a)(ae,2),oe=re[0],ie=re[1],se=Object(a.useState)(),le=Object(j.a)(se,2),je=le[0],be=(le[1],Object(a.useState)()),fe=Object(j.a)(be,2),Oe=fe[0],me=fe[1],he=Object(a.useState)(),ge=Object(j.a)(he,2),ve=ge[0],xe=ge[1],Ce=A().params,ye=Object(a.useState)(),Ne=Object(j.a)(ye,2),we=Ne[0],ke=Ne[1],Se=ut(T),Ee=Object(j.a)(Se,3),_e=Ee[0],Fe=Ee[1],De=Ee[2];Object(a.useEffect)((function(){T&&(R(T).then((function(e){e.data.users.length>0&&H(e.data.users[0])})),De())}),[T]),Object(a.useEffect)((function(){var e=[];O.usernames&&O.usernames.length>0&&e.concat(O.usernames.map((function(e){return"@".concat(e.label)}))),B(e.join(","))}),[O]);var Ae=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.reset,n=e.refresh,c=e.cancel;me(!0);var a=Object(u.a)(Object(u.a)({groups:[],usernames:[],order:oe,skip:n||t?0:v.length,size:"small",following:!0},O),{},{limit:n&&!t?v.length:null!=O.limit?O.limit:5});return dn(a,{cancel:c}).then((function(e){xe(e.data.end),t||n?(x(e.data.docs.map((function(e){return e._id}))),ce(oe)):(x((v||[]).concat(e.data.docs.map((function(e){return e._id})))),window.scrollTo(0,document.body.scrollHeight)),me(!1)}))}),[Ce,O,v,oe]);return y("post/create",(function(){"hot"!==oe&&Ae({refresh:!0})})),y("post/delete",(function(e){S===e&&E(),P(Object(u.a)(Object(u.a)({},L),{},Object(g.a)({},e,!0)))})),Object(a.useEffect)((function(){var e={};$||(Ce&&Ce.get("group")?(e.groups=[Ce.get("group")],ke(Ce.get("group"))):ke(),Ce&&Ce.get("limit")&&(e.limit=Ce.get("limit")),T&&(e.usernames=[T]),m(e))}),[Ce,T,$]),Object(a.useEffect)((function(){var e;return Ae({reset:!0,cancel:function(t){return e=t}}),function(){e&&e()}}),[O]),Object(a.useEffect)((function(){var e;return oe!==te&&Ae({refresh:!0,cancel:function(t){return e=t}}),function(){e&&e()}}),[oe,te]),Object(a.useEffect)((function(){i.view_type&&ie(i.view_type)}),[i]),Object(c.jsxs)("div",{className:J(Gn({loading:!v,empty:v&&0===v.length}),n),children:[Object(c.jsxs)(ue,{theme:t,children:[Object(c.jsxs)("div",{className:Gn("header"),children:[we?Object(c.jsx)(xt,{color:"primary",bg:"secondary",name:we,hideJoined:!0}):Object(c.jsx)(de,{className:Gn("title"),color:"primary",bg:"secondary",themed:!0,children:W?W.display_name:"All"}),T&&K&&K.username!==T&&Object(c.jsx)(pe,{label:_e?"Unfollow":"Follow",onClick:Fe}),Object(c.jsx)(En,{className:Gn("search"),placeholder:"user: / group: / text: / media:",inactiveText:D,blocks:[/\b(user|text|media|group):/i],onOpen:function(){return Q(!0)},onClose:function(){return Q(!1)},suggestion:{user:Dn,media:An,group:Bn},onSearch:function(e){m({following:!1,groups:[we].concat(Object(Z.a)(e.filter((function(e){return"group"===e.type})).map((function(e){return e.value})))),usernames:e.filter((function(e){return"user"===e.type})).map((function(e){return e.value})),content:e.filter((function(e){return"text"===e.type})).map((function(e){return e.value}))})}}),!$&&Object(c.jsxs)("div",{className:Gn("views"),children:[Object(c.jsx)(pe,{label:"Hot",icon:"FlashOn",outlined:"hot"===oe,onClick:function(){return s("view_type","hot")}}),Object(c.jsx)(pe,{label:"New",icon:"ArrowDownward",outlined:"new"===oe,onClick:function(){return s("view_type","new")}}),Object(c.jsx)(pe,{label:"Old",icon:"ArrowUpward",outlined:"old"===oe,onClick:function(){return s("view_type","old")}}),Object(c.jsx)(pe,{icon:"Autorenew",onClick:function(){return Ae({refresh:!0})}})]})]}),(!T||K&&T===K.username||W)&&Object(c.jsx)(In,{defaultValue:{mention:W&&[W],group:we&&[{name:we}]}})]}),Object(c.jsxs)("div",{className:Gn("posts"),children:[Object(c.jsx)(Kn,{width:300,children:v&&v.length>0?v.filter((function(e){return!L[e]})).map((function(e){return Object(c.jsx)(Vn,{id:e,size:"small",onClick:function(){return E(e)},truncate:!0},e)})):v?"No posts yet...":"loading..."}),null!=S&&Object(c.jsx)(On,{open:null!=S,onClose:function(){return E()},onDeletePost:function(){return E()},id:S}),v&&v.length>0&&!je&&!ve&&Object(c.jsx)(ue,{theme:t,children:Object(c.jsx)(pe,{className:M({alignSelf:"center",marginBottom:30}),size:"large",icon:Oe?"MoreHoriz":null,label:Oe?null:"Load more posts",onClick:function(){Ae()},outlined:!0,disabled:Oe})})]})]})},$n=K("page_explore"),Qn=function(){var e=A().params,t=Object(a.useState)(),n=Object(j.a)(t,2),r=n[0],o=n[1];return Object(a.useEffect)((function(){e&&e.get("tags")?o(e.get("tags")):o()}),[e]),Object(c.jsx)(Vt,{className:$n(),children:Object(c.jsx)(Ht,{children:Object(c.jsx)(Yn,{query:{tags:r&&r.split(",")}})})})},Xn=K("page_home"),Zn=function(){return U().user?Object(c.jsx)(l.a,{from:"/",to:"/explore"}):Object(c.jsx)(Vt,{className:Xn(),children:Object(c.jsx)(Ht,{children:Object(c.jsx)(Yn,{})})})},ec=K("page_user"),tc=function(){var e=Object(a.useState)(),t=Object(j.a)(e,2),n=t[0],r=t[1],o=Object(l.i)().user,i=Object(a.useState)(),s=Object(j.a)(i,2),u=s[0],b=s[1],d=Object(a.useState)(),f=Object(j.a)(d,2),O=f[0],m=f[1],h=function(e){e&&R([o]).then((function(e){b(e.data.users[0].display_name),m(e.data.users[0].theme)}))};return y("user/update-theme",o,(function(){return h(o)})),Object(a.useEffect)((function(){h(o)}),[o]),u&&O?Object(c.jsxs)(Vt,{className:ec(),title:"".concat(u),theme:O,children:[Object(c.jsx)(Ht,{className:ec("posts"),children:Object(c.jsx)(Yn,{theme:O,nolimit:!0})}),Object(c.jsx)(Cn,{open:n,onClose:r})]}):Object(c.jsx)(Vt,{className:ec(),children:"who is ".concat(o)})},nc=K("page_post"),cc=function(){var e=Object(l.i)().post,t=S((function(e){return bn(e)})),n=Object(j.a)(t,2),r=n[0],o=n[1];return Object(a.useEffect)((function(){o(e)}),[e]),r?Object(c.jsx)(ue,{username:r&&r.user.username,children:Object(c.jsx)(Vt,{className:nc(),title:"".concat(r.user.display_name,"'s post"),children:Object(c.jsx)(Ht,{className:nc("body"),size:"md",children:Object(c.jsx)(Vn,{size:"full",id:e})})})}):null},ac=(n(644),function(){return Object(c.jsx)("div",{className:"App",children:Object(c.jsx)(s.a,{children:Object(c.jsx)(X,{children:Object(c.jsx)(q,{children:Object(c.jsx)(ce,{children:Object(c.jsxs)(l.d,{children:[Object(c.jsx)(l.b,{path:"/",exact:!0,children:Object(c.jsx)(Zn,{})}),Object(c.jsx)(l.b,{path:"/u/:user",children:Object(c.jsx)(tc,{})}),Object(c.jsx)(l.b,{path:"/p/:post",children:Object(c.jsx)(cc,{})}),Object(c.jsx)(l.b,{path:"/explore",children:Object(c.jsx)(Qn,{})})]})})})})})})});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(c.jsx)(r.a.Fragment,{children:Object(c.jsx)(ac,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[645,1,2]]]);